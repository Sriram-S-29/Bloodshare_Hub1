<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">



    <!-- {{!-- <meta http-equiv="refresh" content="4"> --}} -->
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="/Public/css/dash.css" />
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>

<body>

    {{!-- <div class="hed">
        <p>Total Donors : {{C_Tot}} &nbsp;&nbsp;&nbsp;&nbsp; |</p>&nbsp;
    </div><br> --}}
    <div class="redbox">
        <div>
            <img class="himg" src="/Public/img/logonew.png" alt="logo" />
        </div>
        <div class="l">
            <a href="/admin/adminhome">Home</a>
            <div class="dropdown">
                <button class="dropbtn">Camp</button>
                <div class="dropdown-content">
                    <a href="/admin/admincamp">New</a>
                    <a href="/admin/adminCampDetail">Details</a>
                </div>
            </div>
            <a href="/admin/adminDonor">Donor</a>
            <div class="dropdown">
                <button class="dropbtn">Request </button>
                <div class="dropdown-content">
                    <a href="/admin/adminRequest">New </a>
                    <a href="/admin/adminRequestManage">Manage </a>
                </div>
            </div>
            <div class="dropdown">
                <button class="dropbtn">Appointment </button>
                <div class="dropdown-content">
                    <a href="/admin/appointment">Manage</a>
                    <a href="#"> Details</a>
                </div>
            </div>
        </div>
        <div class="dropdown">
            <img class="himg" src="/Public/img/h2.png" alt="profile">
            <div class="dropdown-content">
                <a href="/admin/inventory">Inventery</a>
                <a href="/admin/">Logout</a>
            </div>
        </div>
    </div>

    <aside>
        <div class="bloodStockHead">
            <img width="54" height="54" src="https://img.icons8.com/arcade/64/rh-plus.png" alt="rh-plus" />
            <h1 style="color: whitesmoke;">Blood Storage</h1>
        </div>
        <div class="stock">
            <h2>A+</h2>
            <div class="progress">
                <div class="bar" id="A+ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>A-</h2>
            <div class="progress">
                <div class="bar" id="A-ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>B+</h2>
            <div class="progress">
                <div class="bar" id="B+ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>B-</h2>
            <div class="progress">
                <div class="bar" id="B-ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>O+</h2>
            <div class="progress">
                <div class="bar" id="O+ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>O-</h2>
            <div class="progress">
                <div class="bar" id="O-ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>AB+</h2>
            <div class="progress">
                <div class="bar" id="AB+ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>
        <div class="stock">
            <h2>AB+</h2>
            <div class="progress">
                <div class="bar" id="AB-ProgressBar" role="progressbar" style="width: 0%;" aria-valuemin="0"
                    aria-valuemax="100"></div>
            </div>
        </div>




        </div>

    </aside>

    <div class="dashMain">
        <div class="two">
            <div class="two_one">
                <!-- card1 -->
                <div class="card">
                    <div class="cardhead">
                        <div class="iconbox i1">
                            <i class="fas fa-user icon"></i>
                        </div>
                        <div class="textend">
                            <p>Active Donors</p>
                            <p style="font-weight: 600; font-size:xx-large;">{{activeDonor}}</p>
                            <!-- <h1 class="th1">63</h1> -->
                        </div>
                    </div>
                    <div>
                        <hr class="line">
                    </div>
                    <div class="cardfoot">
                        <p>Total Donors
                    </div>
                </div>

                <!-- card2 -->

                <div class="card">
                    <div class="cardhead">
                        <div class="iconbox i2">
                            <i class=" fas fa-regular fa-calendar-check fa-2xl   icon"></i>

                        </div>
                        <div class="textend">
                            <p>Today Appointment</p>
                            <p style="font-weight: 600; font-size:xx-large;">{{TCount}}</p>
                        </div>
                    </div>
                    <div>
                        <hr class="line">
                    </div>
                    <div class="cardfoot">
                        <p>Total Donors
                    </div>
                </div>


                <!-- card3 -->

                <div class="card">
                    <div class="cardhead">
                        <div class="iconbox i3">
                            <i class=" fas fa-solid fa-database icon"></i>
                        </div>
                        <div class="textend">
                            <p>Blood Storage</p>
                            <p style="font-weight: 600; font-size:xx-large;">{{totalCount}}</p>
                        </div>
                    </div>
                    <div>
                        <hr class="line">
                    </div>
                    <div class="cardfoot">
                        <p>Total Donors
                    </div>
                </div>


                <!-- card4 -->

                <div class="card">
                    <div class="cardhead">
                        <div class="iconbox i4">
                            <i class=" fas fa-duotone fa-hourglass-start icon"></i>
                        </div>
                        <div class="textend">
                            <p>Waiting Appointment</p>
                            <p style="font-weight: 600; font-size:xx-large;">{{WTCount}}</p>
                        </div>
                    </div>
                    <div>
                        <hr class="line">
                    </div>
                    <div class="cardfoot">
                        <p>Total Donors
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="two_oneD">
        <div class="twobox">
            <div class="chartInfo">
                <div class="chartDiv">
                    <canvas id="myChart3" class="chart3" height="212" width="450"
                        style="display: block; box-sizing: border-box; height: 170px; width: 282.7px;"></canvas>

                </div>

                <div class="chartContent">
                    <p class="chartText">Blood Usage</p>
                    <div>
                        <hr class="line">
                    </div>
                    <p> As Per Month</p>
                </div>
            </div>
        </div>
        <div class="containerblood">
            <div class="outerflex">
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.a_p}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF A+</p> --}}
                        </div>
                        <div class="rightbox">
                            <img class="child" src="/Public/img/A+.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.a_n}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF A-</p> --}}
                        </div>
                        <div class="rightbox">
                            <img class="child" src="/Public/img/A-.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.ab_p}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF AB+</p> --}}
                        </div>
                        <div class="rightbox">
                            <img class="child"  src="/Public/img/AB+.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.ab_n}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF AB-</p> --}}
                        </div>
                        <div class="rightbox">
                            <img  class="child" src="/Public/img/AB-.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.b_p}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF B+</p> --}}
                        </div>
                        <div class="rightbox">
                            <img  class="child" src="/Public/img/B+.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.b_n}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF B-</p> --}}
                        </div>
                        <div class="rightbox">
                            <img  class="child" src="/Public/img/B-.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.o_p}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF O+</p> --}}
                        </div>
                        <div class="rightbox">
                            <img  class="child" src="/Public/img/O+.png" alt="">
                        </div>
                    </div>
                </div>
                <div class="box">
                    <div class="innerflex">
                        <div class="leftbox">
                            <div class="kodu">
                                <p>{{bloodGroups.o_n}}</p>
                            </div>
                            {{!-- <p>THE TOTAL COUNT OF O-</p> --}}
                        </div>
                        <div class="rightbox">
                            <img  class="child" src="/Public/img/O-.png" alt="">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="twobox">
            <div class="chartInfo">
                <div class="chartDiv">
                    <canvas id="myChart1" class="chart1" height="212" width="450"
                        style="display: block; box-sizing: border-box; height: 170px; width: 282.7px;"></canvas>
                </div>

                <div class="chartContent">
                    <p class="chartText">Blood Usage </p>
                    <div>
                        <hr class="line">
                    </div>
                    <p>Grouped By BloodGroup</p>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div class="three">
        <div class="threeOne">
            <div>
                <p id="rankHead">Top Contributors</p>
            </div>
            <div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Photo</th>
                            <th>Donated Times</th>
                            <th>Blood Group</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each topUsers}}
                        <tr>
                            <td>{{this.name}}</td>
                            <td id="r">
                                <div class="ranki"><img src="../../Public/img/uploaded-images/{{this.image}}"
                                        class="rankPhoto" alt="photo"></div>
                            </td>
                            <td>{{this.donatedTimes}}</td>
                            <td>{{this.bloodGroup}}</td>

                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </div>









         <div class="threeTwo">
            <div>
                <p id="rankHead" style="
                padding: 8%;
            ">Camp Details</p>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>Camp Id</th>
                        <th>District</th>
                        <th>Date</th>
                    </tr>
                </thead>

                {{#each AllCamp}}
                <tr>
                    <td>{{this.campId}}</td>
                    <td>{{this.district}}</td>
                    <td>{{this.date}}</td>
                </tr>
                {{/each}}
            </table>
        </div>

    </div>

    <div>
        <button onclick="sweet()">Sweet</button>
    </div> 


        {{!-- <div class="threeTwo">
            <div class="distcount">
                <p>Theni</p>
                <div class="count">
                    <div class="dis" id="Theni" role="progressbar" style="width: 100%;" aria-valuemin="10"
                        aria-valuemax="100"></div>
                </div>
            </div>

        </div> --}}

    </div>
    <script>

        const bloodInventoryCounts = JSON.parse('{{{bloodInventoryCounts}}}');
        console.log(bloodInventoryCounts)

        if (bloodInventoryCounts) {
            Object.keys(bloodInventoryCounts).forEach((bloodType) => {
                const count = bloodInventoryCounts[bloodType] * 10;
                const progressBar = document.getElementById(`${bloodType}ProgressBar`);

                if (progressBar) {
                    progressBar.style.transition = 'width 0.5s, background-color 1.1s';
                    if (count < 10) {
                        progressBar.style.width = `100%`;
                        startBlinking(progressBar);
                    } else {
                        progressBar.style.width = `${count}%`;
                        stopBlinking(progressBar);
                        progressBar.style.backgroundImage = 'linear-gradient(195deg, #ec407a, #d81b60)';
                    }
                }
            });
        }

        function startBlinking(element) {
            element.blinkInterval = setInterval(() => {
                element.style.backgroundColor = element.style.backgroundColor === 'red' ? 'transparent' : 'red';
            }, 500);
        }

        function stopBlinking(element) {
            clearInterval(element.blinkInterval);
            element.style.backgroundColor = 'transparent';

        }


        const countStats = JSON.parse('{{{countStats}}}')
        console.log(countStats);
        console.log(countStats.Jan);

        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        const dataValues = months.map((month, index) => {
            return { x: index, y: countStats[month] || 0 };
        });
        console.log("chechking")
        console.log(dataValues)

        const data = {
            labels: months.map(month => month.substring(0, 1)),
            datasets: [{
                data: dataValues,
                backgroundColor: 'rgb(255, 255, 255)',
                borderColor: 'rgb(255, 255, 255)',
                borderWidth: 5.5
            }]
        };



        const config = {
            type: 'line',
            data: data,
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.3)',
                            borderDash: [0, 10],
                            display: true
                        },
                        ticks: {
                            color: 'rgb(255, 255, 255)',
                            display: false
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.3)',
                            borderDash: [5, 5],
                            display: false
                        },
                        ticks: {
                            color: 'rgb(255, 255, 255)',
                            display: true
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                },
                elements: {
                    point: {
                        backgroundColor: 'rgb(255, 255, 255)',
                        borderColor: 'rgb(255, 255, 255)',
                        borderWidth: 47
                    },
                    line: {
                        backgroundColor: 'rgb(255, 255, 255)',
                        borderColor: 'rgb(255, 255, 255)',
                        borderWidth: 100
                    }
                }
            }
        };
        console.log("Doned")

        var myChart = new Chart(document.getElementById('myChart3'), config);

        console.log("printing")
        const Stat = JSON.parse('{{{overall}}}');
        const data1 = {
            labels: ['A+', 'A-', 'B+', 'B-', 'AB+', 'AB-', 'O+', 'O-'],
            datasets: [{
                label: 'Blood Type Counts',
                data: Stat,
                backgroundColor: 'rgba(54, 162, 235,)',
                borderColor: 'rgba(255, 255, 255, 1)',
                borderWidth: 1,
                borderDash: [5, 5],
                barThickness: 5,
                borderRadius: 5
            }]
        };
        const configs = {
            type: 'bar',
            data: data1,
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.3)',
                            borderDash: [15, 15],
                            drawBorder: false,
                        },
                        ticks: {
                            color: 'rgb(255, 255, 255)',
                            display: false
                        }
                    },
                    x: {
                        grid: {
                            color: 'rgba(255, 255, 255, 0.3)',
                            borderDash: [5, 5],
                            display: false
                        },
                        ticks: {
                            color: 'rgb(255, 255, 255)',
                            display: true
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                },
                elements: {
                    point: {
                        backgroundColor: 'rgb(255, 255, 255)',
                        borderColor: 'rgb(255, 255, 255)',
                        borderWidth: 4
                    },
                    line: {
                        backgroundColor: 'rgb(255, 255, 255)',
                        borderColor: 'rgb(255, 255, 255)',
                        borderWidth: 1
                    },
                    bar: {
                        borderWidth: 10.1 // Adjust the width of the inside bar lines
                    }
                }
            }
        };
        configs.data.datasets.forEach(function (dataset) {
            dataset.borderWidth = 2.5;
        });


        var ctx = document.getElementById('myChart1').getContext('2d');
        var myChart1 = new Chart(ctx, configs);

    </script>


</body>

</html>